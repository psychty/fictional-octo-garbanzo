<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapping points</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css", type="text/css"/> <!-- You need to add the leaflet style sheet-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css", type = 'text/css'/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css", type = 'text/css'/>
    <link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>

    <h1>Simple background map</h1>

    <h2>UK map</h2>
    <p>The first map is UK countries. The background tiles may be sufficient to show UK and you might not want to show the purple lines on the map. All this is customisable in the app.js file.</p>
    <div id="map_1_id"></div>
    <p>Zooming is disabled on this map.</p>
    <p>However, you can use the control in the top right corner to toggle the outlines off and on.</p>
   
    <h2>Ploting points</h2>
    <p>The second map is zoomed in on CP towers, with the background tile set to the coloured tiles. Again customisable in app.js and I have annotated most parts.</p>

    <div id='map_2_id'></div>   

    <h2>Plotting thousands of points</h2>
    <p>Whatever method of getting data together for plotting, this section shows cluster maps, density maps, as well as controls for changing layers.</p>
    <p>I have used R to generate a set of around 30,000 points to plot, as well as randomly assigned age group. You may be able to do this random array in vanilla JS but I just stuck with what i know fast.</p>
    <p>There are a few ways to add multiple points. As a json array you add each marker (a circle this time) by looping through the whole array and plotting a marker for every record. However, it is a hugely resource intensive process for the browser to do this and takes many seconds to load. It is also more difficult to do other things such as group the markers together to enable toggling them in the top right control.</p>
    <p>Another solution to adding all the markers at once is to convert the array to a geojson format which leaflet will handle much easier than plotting through the array. The map below has these markers available but the are not drawn by default (so not lagging the page load). Instead, they are drawn when you click the 'show client geolocations' control box.</p>
    <div id="map_3_id"></div>
    <p>I have recreated my dummy dataset with some weighting for more realistic client bases. In this run, 70% of randomly sampled points are in Englands major towns and cities, with the remainder split across the UK. </p>
    <p>You would probably expect some non random clustering of real world clients and so this approach allows for some areas to be more densely covered.</p>

    <h2>Plotting thousands of points by age</h2>
    <p>Let's stick with all points for a second and show on the next map different formatting by attribute (Age).</p>
    <p>You can toggle drawing each age group in the control. <b>Note</b> I have purposefully set the radius to 5 instead of .1, this means that at UK level the dots will be very large but easier to see once you zoom in. <b>You can change the radius based on zoom level but lets deal with that later.</b></p>
    <div id="map_4_id"></div>

    <h2>Plotting clusters of thousands of points</h2>
    <p>Finally, what you came for. Here all dots are plotted together (rather than being added as individual subsets).</p>
    <p>This time I have drawn the points rather that hiding them as it is much quicker to draw these.</p>
    <div id="map_5_id"></div>
    <p>There are many options to add to the clustering.</p>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script> <!-- I am using this to load data and run maps only when data available -->
    <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script> <!-- You need to add the leaflet style sheet-->
    <script src='https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js'></script> <!-- This plug in is for marker clustering -->
    <script src="app.js"></script>   
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/heatmap.js/2.0.2/heatmap.min.js"></script> <!-- heatmap-->
    <!-- <script src="https://cdn.jsdelivr.net/npm/leaflet-heatmap@1.0.0/leaflet-heatmap.js"></script> --> -->
   

 </body>
 </html>   